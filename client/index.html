<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Hold'em Poker - Game Client</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- Onboarding Screen -->
    <div id="onboardingScreen" class="screen active">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h1>‚ô†Ô∏è Texas Hold'em Poker ‚ô•Ô∏è</h1>
                <p class="tagline">Join a game and test your poker skills!</p>
                <!-- Connection Status (compact) -->
                <div class="connection-status-box" style="display: inline-flex; margin-top: 10px;">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <span id="statusText" style="font-size: 0.9em;">Connecting...</span>
                </div>
            </div>

            <div class="onboarding-panel">
                <h2>üéÆ Get Started</h2>
                
                <!-- Hidden WebSocket URL -->
                <input type="hidden" id="wsUrl" value="ws://localhost:8081/ws/poker">
                
                <!-- Step 1: Register -->
                <div class="onboarding-step" id="registerStep">
                    <h3>1Ô∏è‚É£ Register Your Player</h3>
                    <div class="input-group">
                        <label>Player Name:</label>
                        <input type="text" id="playerName" placeholder="Enter your name">
                    </div>
                    <div class="input-group">
                        <label>Starting Chips:</label>
                        <input type="number" id="startingChips" value="1000" min="100">
                    </div>
                    <button class="btn-success btn-large" onclick="registerPlayer()" id="btnRegister">REGISTER</button>
                    
                    <div class="input-group" id="playerIdDisplay" style="display: none; margin-top: 15px;">
                        <label>Your Player ID:</label>
                        <input type="text" id="playerIdText" readonly style="cursor: pointer;" onclick="copyPlayerId()" title="Click to copy">
                    </div>
                </div>

                <!-- Step 2: Join Lobby -->
                <div class="onboarding-step" id="lobbyStep">
                    <h3>2Ô∏è‚É£ Create or Join a Lobby</h3>
                    
                    <!-- Show current chips -->
                    <div id="currentChipsDisplay" style="display: none; background: rgba(255, 215, 0, 0.2); padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                        <span style="color: #ffd700; font-weight: bold;">üí∞ Your Chips: $</span>
                        <span id="currentChipsAmount" style="color: #fff; font-weight: bold; font-size: 1.2em;">0</span>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-primary btn-large" onclick="createLobby()" id="btnCreateLobby">CREATE LOBBY</button>
                        <button class="btn-primary btn-large" onclick="joinLobby()" id="btnJoinLobby">JOIN LOBBY</button>
                    </div>
                    
                    <div id="lobbyIdDisplay" style="display: none; margin-top: 15px;">
                        <div class="input-group">
                            <label>Lobby ID (Share with friends):</label>
                            <input type="text" id="lobbyIdText" readonly style="cursor: pointer;" onclick="copyLobbyId()" title="Click to copy">
                        </div>
                        <button class="btn-danger btn-large" onclick="leaveLobby()" id="btnLeaveLobby" style="margin-top: 10px;">LEAVE LOBBY</button>
                    </div>

                    <!-- Lobby Players List -->
                    <div id="lobbyPlayersContainer" style="display: none; margin-top: 20px;">
                        <h4 style="color: #ffd700;">üë• Players in Lobby</h4>
                        <div id="lobbyPlayersList" class="lobby-players-list"></div>
                        <button class="btn-warning btn-large" onclick="startGame()" id="btnStart" disabled style="margin-top: 15px;">START GAME</button>
                    </div>
                </div>
            </div>

            <!-- Message Log -->
            <div class="onboarding-log">
                <h3>üìã Messages</h3>
                <div class="messages" id="messages"></div>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <div class="game-container">
            <!-- Header with game info -->
            <div class="game-header">
                <div class="game-info">
                    <span class="lobby-id-header">Lobby: <span id="lobbyIdHeaderDisplay">-</span></span>
                    <span class="player-chips-header">| üí∞ Chips: $<span id="playerChipsHeader">0</span></span>
                </div>
                <div class="connection-status-small">
                    <div class="status-indicator" id="statusIndicatorGame"></div>
                    <span id="statusTextGame">Connected</span>
                </div>
            </div>

            <!-- Main Table Area (Centered) -->
            <div class="table-container">
                <!-- Poker Table with Players Around It -->
                <div class="poker-table-game">
                    <!-- Player Seats (9 positions around table) -->
                    <div id="playerSeats" class="player-seats">
                        <!-- Position 0: Bottom Center (You) -->
                        <div class="player-seat seat-0" id="seat-0" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                            <div class="player-cards-display"></div>
                        </div>

                        <!-- Positions 1-8: Other players around table -->
                        <div class="player-seat seat-1" id="seat-1" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-2" id="seat-2" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-3" id="seat-3" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-4" id="seat-4" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-5" id="seat-5" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-6" id="seat-6" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-7" id="seat-7" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>

                        <div class="player-seat seat-8" id="seat-8" style="display: none;">
                            <div class="player-info">
                                <div class="player-avatar">üë§</div>
                                <div class="player-details">
                                    <div class="player-name-display"></div>
                                    <div class="player-chips-display">$0</div>
                                </div>
                                <div class="player-action-indicator"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Center Table Area -->
                    <div class="table-center">
                        <!-- Pot Display -->
                        <div class="pot-display-center">
                            <div class="pot-label">POT</div>
                            <div class="pot-amount" id="potAmountGame">$0</div>
                        </div>

                        <!-- Community Cards -->
                        <div class="community-cards-center" id="communityCardsGame">
                            <div class="card empty"></div>
                            <div class="card empty"></div>
                            <div class="card empty"></div>
                            <div class="card empty"></div>
                            <div class="card empty"></div>
                        </div>

                        <!-- Current Bet Info -->
                        <div class="bet-info">
                            <span>Current Bet: <span id="currentBetGame">$0</span></span>
                        </div>
                    </div>
                </div>

                <!-- Your Cards (Bottom of screen) -->
                <div class="your-cards-container">
                    <h3>üÉè Your Cards</h3>
                    <div class="your-hand" id="yourHandGame">
                        <div class="card empty"></div>
                        <div class="card empty"></div>
                    </div>
                </div>
            </div>

            <!-- Action Panel (Bottom) -->
            <div class="action-panel-bottom">
                <!-- Lobby Actions (shown when in lobby, before game starts) -->
                <div id="lobbyActionsPanel" style="display: none; text-align: center;">
                    <div style="background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #ffd700;">
                        <h3 style="color: #ffd700; margin-bottom: 10px;">üè† Lobby Information</h3>
                        <div style="background: rgba(255,215,0,0.1); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <p style="color: #ffd700; font-weight: bold; margin-bottom: 5px;">Share this Lobby ID with friends:</p>
                            <input type="text" id="lobbyIdFooter" readonly onclick="copyLobbyIdFooter()" 
                                   style="width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 2px solid #ffd700; 
                                          border-radius: 5px; color: #fff; text-align: center; font-size: 1.1em; cursor: pointer; 
                                          font-family: monospace;" title="Click to copy">
                        </div>
                        <p style="color: #aaa; font-size: 0.9em; margin-bottom: 15px;">Waiting for game to start...</p>
                    </div>
                    <button class="btn-warning btn-large" onclick="startGame()" id="btnStartInGame" disabled style="margin-bottom: 10px;">START GAME</button>
                    <button class="btn-danger" onclick="leaveLobby()" id="btnLeaveLobbyInGame">LEAVE LOBBY</button>
                </div>
                
                <!-- Game Actions (shown during game) -->
                <div id="gameActionsPanel" style="display: none;">
                    <div class="bet-controls-game">
                        <input type="number" id="betAmountGame" placeholder="Bet amount" min="0" value="20">
                        <button class="btn-warning" onclick="quickBet('pot')">POT</button>
                        <button class="btn-warning" onclick="quickBet('half')">¬Ω POT</button>
                    </div>
                    <div class="action-buttons-game">
                        <button class="btn-success" onclick="performAction('CHECK')" id="btnCheckGame">CHECK</button>
                        <button class="btn-primary" onclick="performAction('CALL')" id="btnCallGame">CALL</button>
                        <button class="btn-warning" onclick="performAction('RAISE')" id="btnRaiseGame">RAISE</button>
                        <button class="btn-danger" onclick="performAction('FOLD')" id="btnFoldGame">FOLD</button>
                        <button class="btn-secondary" onclick="performAction('ALL_IN')" id="btnAllInGame">ALL IN</button>
                        <button class="btn-info" onclick="dealNext()" id="btnDealGame">DEAL NEXT</button>
                    </div>
                </div>
            </div>
            
            <!-- Game Message Log -->
            <div style="position: fixed; bottom: 10px; right: 10px; width: 350px; background: rgba(0,0,0,0.9); padding: 15px; border-radius: 15px; border: 2px solid #ffd700; max-height: 200px; overflow-y: auto;">
                <h4 style="color: #ffd700; margin-bottom: 10px; font-size: 0.9em;">Game Events</h4>
                <div class="messages" id="gameMessages"></div>
            </div>
        </div>
    </div>

    <script src="./index.js"></script>
</body>
</html>
